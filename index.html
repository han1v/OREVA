<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OREVA OCR â€“ Camera & Image to Text</title>

<!-- OCR -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<!-- Cropper -->
<link href="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.js"></script>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#0f172a;
  color:#fff;
  font-family:Arial,sans-serif;
}
.container{
  width:95%;
  max-width:520px;
  text-align:center;
}
.logo{width:70px;margin-bottom:12px}
button{
  background:#2563eb;
  color:#fff;
  border:none;
  padding:12px 18px;
  border-radius:6px;
  margin:6px;
  font-size:15px;
}
video, img.preview{
  width:100%;
  max-height:70vh;
  border-radius:8px;
  margin-top:10px;
}
textarea{
  width:100%;
  height:180px;
  margin-top:12px;
  border-radius:6px;
  padding:10px;
  resize:none;
}
.hidden{display:none}
.note{font-size:12px;opacity:.7;margin-top:8px}
</style>
</head>

<body>
<div class="container">

<img src="logo.png" class="logo">
<h2>OREVA OCR</h2>
<p>Scan text using camera or image</p>

<input type="file" id="fileInput" accept="image/*"><br>

<button id="startCamera">Use Camera</button>
<button id="capture" disabled>Capture</button>

<video id="video" autoplay class="hidden"></video>

<img id="preview" class="preview hidden">
<br>

<button id="confirmCrop" class="hidden">OK â€“ Use This</button>
<button id="extract" class="hidden">Extract Text</button>

<textarea id="output" placeholder="Extracted text will appear hereâ€¦"></textarea>
<button id="copy">Copy Text</button>

<div class="note">ðŸ”’ OCR runs in your browser. No images uploaded.</div>
</div>

<script>
const video=document.getElementById("video");
const startCamera=document.getElementById("startCamera");
const capture=document.getElementById("capture");
const preview=document.getElementById("preview");
const extract=document.getElementById("extract");
const confirmCrop=document.getElementById("confirmCrop");
const output=document.getElementById("output");
const fileInput=document.getElementById("fileInput");

let stream, cropper, finalImage;

// BACK CAMERA (environment)
startCamera.onclick=async()=>{
  stream=await navigator.mediaDevices.getUserMedia({
    video:{facingMode:{ideal:"environment"}}
  });
  video.srcObject=stream;
  video.classList.remove("hidden");
  capture.disabled=false;
};

// CAPTURE
capture.onclick=()=>{
  const canvas=document.createElement("canvas");
  canvas.width=video.videoWidth;
  canvas.height=video.videoHeight;
  canvas.getContext("2d").drawImage(video,0,0);
  preview.src=canvas.toDataURL("image/png");

  stream.getTracks().forEach(t=>t.stop());
  video.classList.add("hidden");
  preview.classList.remove("hidden");
  confirmCrop.classList.remove("hidden");

  cropper=new Cropper(preview,{viewMode:1,autoCropArea:1});
};

// FILE UPLOAD
fileInput.onchange=e=>{
  const file=e.target.files[0];
  preview.src=URL.createObjectURL(file);
  preview.classList.remove("hidden");
  confirmCrop.classList.remove("hidden");
  cropper=new Cropper(preview,{viewMode:1,autoCropArea:1});
};

// CONFIRM CROP
confirmCrop.onclick=()=>{
  finalImage=cropper.getCroppedCanvas();
  cropper.destroy();
  confirmCrop.classList.add("hidden");
  extract.classList.remove("hidden");
};

// OCR
extract.onclick=()=>{
  extract.textContent="Extractingâ€¦";
  Tesseract.recognize(finalImage,"eng")
  .then(({data:{text}})=>{
    output.value=text;
    extract.textContent="Extract Text";
  });
};

// COPY
document.getElementById("copy").onclick=()=>{
  output.select();
  document.execCommand("copy");
  alert("Copied!");
};
</script>

</body>
</html>
